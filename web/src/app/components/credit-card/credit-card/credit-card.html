<button
  *ngIf="card"
  class="w-full text-left rounded-xl p-4 transition border bg-white hover:bg-muted text-text border-border"
  type="button"
  (click)="onClick()"
  [class.border-primary]="selected"
>
  <div class="w-full h-56 rounded-xl p-6 flex flex-col justify-between text-white bg-gradient-to-r from-gradient-start to-gradient-end shadow-lg">
    <!-- Top Row -->
    <div class="flex justify-between items-center">
      <div class="text-lg font-bold tracking-wider">
        {{ card.brand || 'CARD' }}
      </div>
      <!-- Chip do cartão -->
      <div class="w-12 h-8 rounded-md shadow-inner bg-white/20"></div>
    </div>

    <!-- Card Number + Reveal Button -->
    <div class="text-center text-2xl tracking-widest font-mono flex items-center justify-center gap-3">
      <span>
        {{ showNumber
          ? formatFull(card.cardNumber || card.maskedPan || '')
          : maskCardNumber(card.maskedPan || card.cardNumber || '') }}
      </span>
      <button
        class="text-[10px] font-medium px-2 py-1 rounded bg-white/15 hover:bg-white/25 transition"
        type="button"
        (click)="toggleShowNumber($event)"
        [attr.aria-pressed]="showNumber"
        [title]="showNumber ? 'Ocultar número' : 'Mostrar número'"
      >
        {{ showNumber ? 'Ocultar' : 'Mostrar' }}
      </button>
    </div>

    <!-- Bottom Row -->
    <div class="flex justify-between items-end text-sm">
      <div>
        <div class="uppercase text-xs opacity-75">CARD HOLDER</div>
        <div class="font-semibold tracking-wide">
          {{ card.cardHolderName || 'NOME DO TITULAR' }}
        </div>
      </div>
      <div class="flex flex-col items-end gap-1">
        <div>
          <div class="uppercase text-xs opacity-75">EXPIRES</div>
          <div class="font-semibold tracking-wide">
            {{ formatExpiryDate() }}
          </div>
        </div>
        @if (showNumber && card.cvv) {
          <div>
            <div class="uppercase text-xs opacity-75">CVV</div>
            <div class="font-semibold tracking-wide">
              {{ card.cvv }}
            </div>
          </div>
        } @else if (showNumber && loadingCvv) {
          <div>
            <div class="uppercase text-xs opacity-75">CVV</div>
            <div class="font-semibold tracking-wide text-xs">
              Carregando...
            </div>
          </div>
        } @else if (showNumber && cvvError) {
          <div>
            <div class="uppercase text-xs opacity-75">CVV</div>
            <div class="font-semibold tracking-wide text-xs opacity-60" title="{{ cvvError }}">
              Não disponível
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</button>
