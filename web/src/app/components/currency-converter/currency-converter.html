<div class="bg-white rounded-xl p-4 border border-border h-full flex flex-col">
    <div class="flex justify-between items-center mb-6">
        <div class="flex items-center gap-2">
            <lucide-icon name="ArrowRightLeft" size="20" class="text-primary"></lucide-icon>
            <span class="text-sm text-muted-foreground">Conversor de Moedas</span>
        </div>
        <button class="p-1 hover:bg-muted rounded-lg transition-colors" aria-label="Mais opções">
            <lucide-icon name="MoreHorizontal" size="16" class="text-muted-foreground"></lucide-icon>
        </button>
    </div>

    <div class="flex items-center gap-4 mb-4">
        <div class="flex-1">
            <div class="bg-muted/30 border border-border rounded-xl p-4 relative currency-field">
                <div class="flex items-center justify-between mb-2">
                    <lucide-icon name="ChevronDown" size="16" class="text-muted-foreground"></lucide-icon>
                    <span class="text-sm text-muted-foreground font-medium">{{ fromCurrency }}</span>
                </div>
                <input type="number" [(ngModel)]="amount" placeholder="0"
                    class="w-full text-2xl font-semibold text-text bg-transparent border-none outline-none" min="0.01"
                    step="0.01">
            </div>
        </div>

        <div class="flex-shrink-0">
            <button (click)="convertCurrency()" [disabled]="loading"
                class="w-12 h-12 bg-primary hover:bg-primary/90 text-white rounded-xl flex items-center justify-center transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none convert-button"
                aria-label="Converter">
                <lucide-icon [name]="loading ? 'Loader2' : 'ArrowLeftRight'" [size]="20"
                    [class]="loading ? 'animate-spin' : ''"></lucide-icon>
            </button>
        </div>

        <div class="flex-1">
            <div class="bg-muted/30 border border-border rounded-xl p-4 relative currency-field">
                <div class="flex items-center justify-between mb-2">
                    <lucide-icon name="ChevronDown" size="16" class="text-muted-foreground"></lucide-icon>
                    <span class="text-sm text-muted-foreground font-medium">{{ toCurrency }}</span>
                </div>
                <div class="text-2xl font-semibold text-text">{{ conversionResult ?
                    formatCurrency(conversionResult.convertedAmount, toCurrency) : '0' }}</div>
            </div>
        </div>
    </div>

    <div class="flex items-center gap-4 mb-4">
        <div class="flex-1">
            <select [(ngModel)]="fromCurrency"
                class="w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary bg-background">
                <option *ngFor="let currency of supportedCurrencies" [value]="currency">{{ currency }}</option>
            </select>
        </div>
        <div class="flex-shrink-0">
            <button (click)="swapCurrencies()"
                class="w-8 h-8 bg-muted hover:bg-muted/80 rounded-lg flex items-center justify-center transition-colors"
                [disabled]="loading" aria-label="Inverter moedas">
                <lucide-icon name="ArrowLeftRight" size="14" class="text-muted-foreground"></lucide-icon>
            </button>
        </div>
        <div class="flex-1">
            <select [(ngModel)]="toCurrency"
                class="w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary bg-background">
                <option *ngFor="let currency of supportedCurrencies" [value]="currency">{{ currency }}</option>
            </select>
        </div>
    </div>

    <div *ngIf="conversionResult" class="flex items-center justify-between text-sm mb-4">
        <div class="flex items-center gap-2">
            <span class="font-semibold text-text">Taxa = {{ conversionResult.exchangeRate.toFixed(2) }}</span>
            <div class="flex items-center gap-1">
                <lucide-icon [name]="isRealTimeRate() ? 'Wifi' : 'WifiOff'" size="12"
                    [class]="isRealTimeRate() ? 'text-green-500' : 'text-orange-500'"></lucide-icon>
                <span class="text-xs text-muted-foreground">{{ isRealTimeRate() ? 'Tempo Real' : 'Taxa Fixa' }}</span>
            </div>
        </div>
        <span class="text-muted-foreground text-xs">({{ formatDate(conversionResult.conversionDate) }})</span>
    </div>

    <div *ngIf="error" class="mt-4 p-2 bg-red-50 border border-red-200 rounded-lg" role="alert">
        <div class="flex items-center gap-2">
            <lucide-icon name="AlertCircle" size="14" class="text-red-500"></lucide-icon>
            <span class="text-xs text-red-700">{{ error }}</span>
        </div>
    </div>

    <div class="mt-6 grid grid-cols-3 gap-3">
        <button (click)="amount = 100; fromCurrency = 'USD'; toCurrency = 'BRL'; convertCurrency()"
            class="p-3 text-xs bg-muted/30 hover:bg-muted/50 border border-border rounded-xl transition-colors text-text font-medium">$100
            USD → BRL</button>
        <button (click)="amount = 50; fromCurrency = 'EUR'; toCurrency = 'USD'; convertCurrency()"
            class="p-3 text-xs bg-muted/30 hover:bg-muted/50 border border-border rounded-xl transition-colors text-text font-medium">€50
            EUR → USD</button>
        <button (click)="amount = 1000; fromCurrency = 'BRL'; toCurrency = 'EUR'; convertCurrency()"
            class="p-3 text-xs bg-muted/30 hover:bg-muted/50 border border-border rounded-xl transition-colors text-text font-medium">R$1000
            BRL → EUR</button>
    </div>
</div>